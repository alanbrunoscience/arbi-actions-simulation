name: Build and Deploy

on:
  push:
    branches:
      - master

jobs:
  Deploy_application:
    runs-on: ubuntu-latest

    steps:
      - name: Getting the Source Branch Suffix of the Pull Request Merged
        run: |
          echo '${{ toJSON(github) }}' > github.json
        # cat ${{ toJSON(github) }} | jq ['.event.commits[].message'] | jq .[1] | jq --raw-output 'match(["general-iac", "dev-iac", "pprd-iac", "sdx-iac", "prod-iac"])'
        # echo '${{ toJSON(github) }}' > github.json
        # echo "SOURCE_BRANCH_SUFFIX=$(cat github.json | jq ['.event.commits[].message'] | jq .[1] | jq --raw-output 'match(["general-iac", "dev-iac", "pprd-iac", "sdx-iac", "prod-iac"])')" >> GITHUB_ENV

      - name: Print Source Branch Suffix
        run: cat github.json | jq ['.event.commits[].message'] | jq .[1] | jq --raw-output 'match(["general-iac", "dev-iac", "pprd-iac", "sdx-iac", "prod-iac"])?'

      # - name: Print Source Branch Suffix
      #   run: "echo SOURCE_BRANCH_SUFFIX: ${{ env.SOURCE_BRANCH_SUFFIX }}"

